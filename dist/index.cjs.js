"use strict";var __assign=function(){return(__assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function __awaiter(e,a,s,c){return new(s=s||Promise)(function(n,t){function r(e){try{o(c.next(e))}catch(e){t(e)}}function i(e){try{o(c.throw(e))}catch(e){t(e)}}function o(e){var t;e.done?n(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(r,i)}o((c=c.apply(e,a||[])).next())})}function __generator(r,i){var o,a,s,c={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},u={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function e(n){return function(e){var t=[n,e];if(o)throw new TypeError("Generator is already executing.");for(;c=u&&t[u=0]?0:c;)try{if(o=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return c.label++,{value:t[1],done:!1};case 5:c.label++,a=t[1],t=[0];continue;case 7:t=c.ops.pop(),c.trys.pop();continue;default:if(!(s=0<(s=c.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){c=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))c.label=t[1];else if(6===t[0]&&c.label<s[1])c.label=s[1],s=t;else{if(!(s&&c.label<s[2])){s[2]&&c.ops.pop(),c.trys.pop();continue}c.label=s[2],c.ops.push(t)}}t=i.call(r,c)}catch(e){t=[6,e],a=0}finally{o=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}}function __values(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&r>=e.length?void 0:e)&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function __spreadArray(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||((r=r||Array.prototype.slice.call(t,0,i))[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}function __asyncValues(a){var e,t;if(Symbol.asyncIterator)return(e=a[Symbol.asyncIterator])?e.call(a):(a="function"==typeof __values?__values(a):a[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);throw new TypeError("Symbol.asyncIterator is not defined.");function n(o){t[o]=a[o]&&function(i){return new Promise(function(e,t){var n,r;i=a[o](i),n=e,e=t,r=i.done,t=i.value,Promise.resolve(t).then(function(e){n({value:e,done:r})},e)})}}}var EventEmitter=function(){function e(){this.events={}}return e.prototype.on=function(e,t,n,r){this.events||(this.events={}),!this.events[e]||n?this.events[e]=[t]:r?this.events[e].unshift(t):this.events[e].push(t)},e.prototype.emit=function(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];this.events[e]&&this.events[e].forEach(function(e){return e.call.apply(e,__spreadArray([t],n,!1))})},e.prototype.once=function(r,i){var o=this;o.on(r,function e(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];i.call.apply(i,__spreadArray([this],t,!1)),o.off(r,e)})},e.prototype.off=function(e,t){this.events[e]&&(t=this.events[e].indexOf(t),this.events[e].splice(t,1))},e}(),EventEmitter$1=new EventEmitter;function normalizePerformanceRecord(n){return Object.keys(n).forEach(function(e){var t=n[e];"number"==typeof t&&(n[e]=0===t?void 0:parseFloat(t.toFixed(2)))}),n}function getUUid(){return(new Date).getTime()}var arrayMap=Array.prototype.map||function(e){for(var t=[],n=0;n<this.length;n+=1)t.push(e(this[n],n,this));return t};function map(e,t){return arrayMap.call(e,t)}function createObserver(t,p,f){var n=this,l={};return new Promise(function(u,e){new PerformanceObserver(function(c){return __awaiter(n,void 0,void 0,function(){var t,n,r,i,o,a,s;return __generator(this,function(e){switch(e.label){case 0:e.trys.push([0,5,6,11]),t=!0,n=__asyncValues(c.getEntries()),e.label=1;case 1:return[4,n.next()];case 2:if(s=e.sent(),i=s.done)return[3,4];s=s.value,t=!1;try{"navigation"===(r=s).entryType?l[r.entryType]=__assign({},r.toJSON()):"resource"===r.entryType?"xmlhttprequest"===r.initiatorType&&r.name.includes("api/")&&(l.resource=l.resource||{},l.resource[r.name]=__assign({},r.toJSON())):l[r.name]={name:r.name,entryType:r.entryType,startTime:r.startTime,duration:r.duration}}finally{t=!0}e.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return s=e.sent(),o={error:s},[3,11];case 6:return e.trys.push([6,,9,10]),t||i||!(a=n.return)?[3,8]:[4,a.call(n)];case 7:e.sent(),e.label=8;case 8:return[3,10];case 9:if(o)throw o.error;return[7];case 10:return[7];case 11:return u(l),a=f,p&&l[p]&&JSON.stringify(a)!==JSON.stringify(l[p])&&(a=__assign({},l[p]),console.log("---343245",l[p]),EventEmitter$1.emit(p,l[p])),[2]}})})}).observe(t)})}var sendBeacon=navigator.sendBeacon?function(e,t){t&&navigator.sendBeacon(e,JSON.stringify(t))}:function(e,t){(new Image).src="".concat(e,"?v=").concat(encodeURIComponent(JSON.stringify(t)))},nextTime=window.requestIdleCallback||window.requestAnimationFrame||function(e){return setTimeout(e,17)},MAX_CACHE_LEN=5,MAX_WAITING_TIME=5e3,supported={performance:!!window.performance,getEntriesByType:!(!window.performance||!performance.getEntriesByType),PerformanceObserver:"PerformanceObserver"in window,MutationObserver:"MutationObserver"in window,PerformanceNavigationTiming:"PerformanceNavigationTiming"in window},baseUUid=getUUid(),reqUrl="",events=[],timer=null,base={pageId:baseUUid,appName:""},init=function(e){var t=e.appName,e=e.requestUrl;reqUrl=e,base.appName=t};function emit(e,t){void 0===t&&(t=!1),events=events.concat(e),clearTimeout(timer),events.length>=MAX_CACHE_LEN||t?send():timer=setTimeout(function(){send()},MAX_WAITING_TIME)}function send(){var e,t;events.length&&(e=events.slice(0,MAX_CACHE_LEN),events=events.slice(MAX_CACHE_LEN),debug("send events",e),t=Date.now(),console.log("===2",reqUrl),sendBeacon(reqUrl,{baseInfo:__assign(__assign({},base),{sendTime:t}),eventInfo:map(e,function(e){if(e.sendTime=t,"click"===e.eventType||"scroll"===e.eventType||"submit"===e.eventType||"change"===e.eventType)e.type="mix";else if("performance"===e.eventType)switch(e.eventId){case"resource":e.type="resourcePerformance";break;case"page":e.type="pagePerformance";break;case"server":e.type="serverPerformance"}else e.type=e.eventType;return e})}),events.length)&&nextTime(send)}function debug(){for(var e=0;e<arguments.length;e++)e,0}var base$1={init:init},init$1=function(e){e.pv&&emit({type:"behavior",subType:"pv",uuid:getUUid(),data:{url:window.location.href,refer:document.referrer,action:window.performance.navigation.type,size:"".concat(window.screen.width,"*").concat(window.screen.height),title:e.title||document.title}})},pv={init:init$1};function init$2(e){e.eventCore}var event={init:init$2};function observeNavigationTiming(){var e,t={fmp:0},n=window.performance,r=n.timing;supported.getEntriesByType&&((e=n.getEntriesByType("paint")).length&&(t.fmp=e[e.length-1].startTime),supported.PerformanceNavigationTiming)&&(e=n.getEntriesByType("navigation")[0])&&(r=e),t.fpt=r.responseEnd-r.fetchStart,t.tti=r.domInteractive-r.fetchStart,t.ready=r.domContentLoadedEventEnd-r.fetchStart,t.loadon=r.loadEventStart-r.fetchStart,t.firstbyte=r.responseStart-r.domainLookupStart,t.dns=r.domainLookupEnd-r.domainLookupStart,t.appcache=r.domainLookupStart-r.fetchStart,t.tcp=r.connectEnd-r.connectStart,t.ttfb=r.responseStart-r.requestStart,t.trans=r.responseEnd-r.responseStart,t.dom=r.domInteractive-r.responseEnd,t.res=r.loadEventStart-r.domContentLoadedEventEnd,t.ssllink=r.connectEnd-r.secureConnectionStart,t.redirect=r.redirectEnd-r.redirectStart,t.unloadTime=r.unloadEventEnd-r.unloadEventStart,sendFristData("calc",t)}function sendFristData(e,t){e="observer"===e?t:{firstPaint:t["first-paint"].startTime,firstContentfulPaint:t["first-contentful-paint"].startTime,sslLinkTimes:t.navigation.connectEnd-t.navigation.secureConnectionStart,redirectTimes:t.navigation.redirectEnd-t.navigation.redirectStart,unLoadTime:t.navigation.unloadEventEnd-t.navigation.unloadEventStart};emit({type:"performance",subType:"document",data:normalizePerformanceRecord(__assign({},e)),uuid:baseUUid})}function init$3(e){var t=e.performanceFirstResource,e=e.performanceCore;(t||e)&&(supported.PerformanceObserver?createObserver({entryTypes:["paint","navigation"]}).then(function(e){sendFristData("observer",e)}):observeNavigationTiming())}var performance$1={init:init$3},RequestTemplate=function(t){void 0===t&&(t={});var n=this;["src","method","duration","responseStatus"].forEach(function(e){n[e]=t[e]||null})};function tracePerformance(e,t){var n,r={};"server"===e?r=t:(n=Date.now(),Object.keys(t).forEach(function(e){r[e]={triggerTime:n,url:window.location.href,apiTimes:t[e].startTime,durationTimes:t[e].duration,responseEndTime:t[e].responseEnd}})),emit({type:"performance",subType:"resourceApi",uuid:baseUUid,triggerTime:Date.now(),data:normalizePerformanceRecord(r)})}function interceptAjax(){var e=XMLHttpRequest.prototype.send,o=new RequestTemplate;XMLHttpRequest.prototype.send=function(r){var i=this;return console.log("=========3",r),this.addEventListener("readystatechange",function(){var e=i.readyState,t=i.status,n=i.responseURL,n=void 0===n?o.src:n;i.responseText;4===e&&tracePerformance("server",{url:n,responseStatus:t,duration:Date.now()-o.triggerTime,params:r||void 0})}),o.triggerTime=Date.now(),e.call(this,r)}}function init$4(e){var t=e.performanceServer,e=e.errorServer;(t||e)&&interceptAjax()}var http={init:init$4},init$5=function(e){base$1.init(e),pv.init(e),event.init(e),performance$1.init(e),http.init(e)},index={init:init$5};module.exports=index;
